{"paragraphs":[{"title":"CREATE STAGING","text":"%hive\n\n--prepare db for storing tables\n--create staging pae_staging.db\n\ncreate database if not exists pae_staging;\n","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-15T21:38:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1615840191185_789024175","id":"20210315-202951_1204645757","dateCreated":"2021-03-15T20:29:51+0000","dateStarted":"2021-03-15T21:09:22+0000","dateFinished":"2021-03-15T21:09:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:165051"},{"text":"%sh\nhdfs dfs -find / -name \"*pae*\"","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:20:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1615926039930_-654103482","id":"20210316-202039_1520075619","dateCreated":"2021-03-16T20:20:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:182445","dateFinished":"2021-03-16T20:20:52+0000","dateStarted":"2021-03-16T20:20:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\n/apps/hive/warehouse/pae_staging.db\n/user/zeppelin/.Trash/210315230000/apps/hive/warehouse/pae_staging.db\n/user/zeppelin/.Trash/210316180000/apps/hive/warehouse/pae_staging.db\n/user/zeppelin/.Trash/210316190000/apps/hive/warehouse/pae_staging.db\n/user/zeppelin/.Trash/Current/apps/hive/warehouse/pae_staging.db\n"}]}},{"text":"%md\n# Get Data from mySQL \n","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-15T21:17:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Get Data from mySQL</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1615842703696_1498322471","id":"20210315-211143_1167132456","dateCreated":"2021-03-15T21:11:43+0000","dateStarted":"2021-03-15T21:17:03+0000","dateFinished":"2021-03-15T21:17:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165052"},{"title":"GET SCHEMA FROM skillfactory.cities","text":"%mysql\ndescribe skillfactory.cities","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-15T21:38:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Field":"string","Type":"string","Null":"string","Key":"string","Default":"string","Extra":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Field\tType\tNull\tKey\tDefault\tExtra\nCountry\tvarchar(255)\tYES\t\tnull\t\nCity\tvarchar(255)\tYES\t\tnull\t\nAccentCity\tvarchar(255)\tYES\t\tnull\t\nRegion\tvarchar(255)\tYES\t\tnull\t\nPopulation\tdecimal(10,0)\tYES\t\tnull\t\nLatitude\tdecimal(10,0)\tYES\t\tnull\t\nLongitude\tdecimal(10,0)\tYES\t\tnull\t\n"}]},"apps":[],"jobName":"paragraph_1615841196494_1264739521","id":"20210315-204636_1189177046","dateCreated":"2021-03-15T20:46:36+0000","dateStarted":"2021-03-15T21:12:53+0000","dateFinished":"2021-03-15T21:12:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165053"},{"title":"CREATE CITIES IN PAE_STAGING","text":"%hive\n\nCREATE EXTERNAL TABLE IF NOT EXISTS pae_staging.cities(\n    Country varchar(255),\n    City varchar(255),\n    AccentCity varchar(255),\n    Region varchar(255),\n    Population decimal(10,0),\n    Latitude decimal(10,0),\n    Longitude decimal(10,0)\n)\n\nrow format delimited\nfields terminated by '\\t'\nlines terminated by '\\n'\nstored as textfile\ntblproperties (\"skip.header.line.count\"=\"1\");\n","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:14:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1615841219048_239860116","id":"20210315-204659_330923091","dateCreated":"2021-03-15T20:46:59+0000","dateStarted":"2021-03-16T20:14:56+0000","dateFinished":"2021-03-16T20:14:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165054"},{"text":"%md\n### Plan: <br> 1. Download table from mysql to csv <br>2. Put csv file to hive","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:19:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1615923506206_1459439161","id":"20210316-193826_815303284","dateCreated":"2021-03-16T19:38:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:175040","dateFinished":"2021-03-16T20:19:14+0000","dateStarted":"2021-03-16T20:19:14+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Plan: <br> 1. Download table from mysql to csv <br>2. Put csv file to hive</h3>\n</div>"}]}},{"title":"DOWNLOAD DATA FROM MYSQL TO /tmp/pae/cities.csv","text":"%sh\n\nmysql  -h '10.93.1.9' -u 'mysql' --password='arenadata' -e 'select * from skillfactory.cities' > /tmp/pae/cities.csv","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:06:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","City":"string","AccentCity":"string","Region":"string","Population":"string","Latitude":"string","Longitude":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1615842838383_-2095480768","id":"20210315-211358_1292093171","dateCreated":"2021-03-15T21:13:58+0000","dateStarted":"2021-03-16T20:06:45+0000","dateFinished":"2021-03-16T20:06:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165055"},{"text":"%sh\nhead /tmp/pae/cities.csv","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:22:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1615924188743_-1434260750","id":"20210316-194948_1983450552","dateCreated":"2021-03-16T19:49:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:177023","dateFinished":"2021-03-16T20:07:11+0000","dateStarted":"2021-03-16T20:07:11+0000","title":"READ HEAD /tmp/pae/cities.csv","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Country\tCity\tAccentCity\tRegion\tPopulation\tLatitude\tLongitude\nad\taixas\tAixÃ s\t06\t0\t42\t1\nad\taixirivali\tAixirivali\t06\t0\t42\t2\nad\taixirivall\tAixirivall\t06\t0\t42\t2\nad\taixirvall\tAixirvall\t06\t0\t42\t2\nad\taixovall\tAixovall\t06\t0\t42\t1\nad\tandorra\tAndorra\t07\t0\t43\t2\nad\tandorra la vella\tAndorra la Vella\t07\t20430\t43\t2\nad\tandorra-vieille\tAndorra-Vieille\t07\t0\t43\t2\nad\tandorre\tAndorre\t07\t0\t43\t2\n"}]}},{"text":"%sh\nhdfs dfs -put /tmp/pae/cities.csv /apps/hive/warehouse/pae_staging.db/cities/file","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:22:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1615925569890_250135735","id":"20210316-201249_664879127","dateCreated":"2021-03-16T20:12:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:179856","dateFinished":"2021-03-16T20:15:56+0000","dateStarted":"2021-03-16T20:15:52+0000","title":"PUT CITIES.CSV TO HIVE","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\n"}]}},{"text":"%hive\nSELECT * FROM pae_staging.cities LIMIT 5","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:22:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"cities.country":"string","cities.city":"string","cities.accentcity":"string","cities.region":"string","cities.population":"string","cities.latitude":"string","cities.longitude":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1615925601758_902023459","id":"20210316-201321_264361391","dateCreated":"2021-03-16T20:13:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:179928","dateFinished":"2021-03-16T20:15:58+0000","dateStarted":"2021-03-16T20:15:57+0000","title":"CHECK pae_staging.cities IF IT IS OK","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cities.country\tcities.city\tcities.accentcity\tcities.region\tcities.population\tcities.latitude\tcities.longitude\nad\taixas\tAixÃ s\t06\t0\t42\t1\nad\taixirivali\tAixirivali\t06\t0\t42\t2\nad\taixirivall\tAixirivall\t06\t0\t42\t2\nad\taixirvall\tAixirvall\t06\t0\t42\t2\nad\taixovall\tAixovall\t06\t0\t42\t1\n"}]}},{"text":"%md\n# Get Data From /home/deng/Data\n","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-15T21:17:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Get Data From /home/deng/Data</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1615843040656_-2062004985","id":"20210315-211720_228788699","dateCreated":"2021-03-15T21:17:20+0000","dateStarted":"2021-03-15T21:17:41+0000","dateFinished":"2021-03-15T21:17:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165057"},{"title":"LIST FILES IN /home/deng/Data","text":"%sh\nhdfs dfs -ls /home/deng/Data","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-15T21:38:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nFound 11 items\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 08:57 /home/deng/Data/capital.json\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 09:51 /home/deng/Data/cities.csv\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 09:00 /home/deng/Data/continent.json\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 06:57 /home/deng/Data/countries_of_the_world.csv\ndrwxr-xr-x   - zeppelin hadoop          0 2020-11-16 21:01 /home/deng/Data/countries_of_the_worldcountries_of_the_world\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 09:12 /home/deng/Data/currency.json\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 09:13 /home/deng/Data/iso3.json\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 09:14 /home/deng/Data/names.json\ndrwxr-xr-x   - hive     hadoop          0 2020-04-09 11:40 /home/deng/Data/nobel-laureates.csv\ndrwxr-xr-x   - hive     hadoop          0 2020-03-27 15:34 /home/deng/Data/nobel_laureates.csv\ndrwxr-xr-x   - hive     hadoop          0 2021-02-13 09:15 /home/deng/Data/phone.json\n"}]},"apps":[],"jobName":"paragraph_1615842108921_1228339116","id":"20210315-210148_1294348554","dateCreated":"2021-03-15T21:01:48+0000","dateStarted":"2021-03-15T21:26:14+0000","dateFinished":"2021-03-15T21:26:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165058"},{"title":"UTILS FOR JSON","text":"%python\nimport itertools\nimport json\n\nimport os\n\nfrom typing import Dict\n\n\ndef read_json(path: str, dict_depth: int = 5) -> Dict:\n    with open(path, 'r') as f:\n        json_content = json.load(f)\n    return dict(itertools.islice(json_content.items(), dict_depth))","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:09:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1615842125460_227119859","id":"20210315-210205_162393633","dateCreated":"2021-03-15T21:02:05+0000","dateStarted":"2021-03-16T20:09:22+0000","dateFinished":"2021-03-16T20:09:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165059"},{"text":"%python\njson_files = [x for x in os.listdir(\"/home/deng/Data\") if x.endswith('json')]\n\nfor j in json_files:\n    print(os.path.basename(j), read_json(j,2), sep=' - ')","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-15T21:36:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"capital.json - {'BD': 'Dhaka', 'BE': 'Brussels'}\ncontinent.json - {'BD': 'AS', 'BE': 'EU'}\ncurrency.json - {'BD': 'BDT', 'BE': 'EUR'}\niso3.json - {'BD': 'BGD', 'BE': 'BEL'}\nnames.json - {'BD': 'Bangladesh', 'BE': 'Belgium'}\nphone.json - {'BD': '880', 'BE': '32'}\n"}]},"apps":[],"jobName":"paragraph_1615843622768_167181993","id":"20210315-212702_915933255","dateCreated":"2021-03-15T21:27:02+0000","dateStarted":"2021-03-15T21:36:47+0000","dateFinished":"2021-03-15T21:36:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165060"},{"title":"CREATE TABLE FOR JSON FILES","text":"%hive\nCREATE EXTERNAL TABLE if not exists pae_staging.capital(\n    country_code varchar(10), \n    capital_name varchar(255)\n    )\nrow format delimited\nfields terminated by ':'\nlines terminated by '\\n'\nstored as textfile;\n\nCREATE EXTERNAL TABLE if not exists pae_staging.continent(\n    country_code varchar(10), \n    continent_code varchar(255)\n    )\nrow format delimited\nfields terminated by ':'\nlines terminated by '\\n'\nstored as textfile;\n\nCREATE EXTERNAL TABLE if not exists pae_staging.currency(\n    country_code varchar(10), \n    currency_code varchar(255)\n    )\nrow format delimited\nfields terminated by ':'\nlines terminated by '\\n'\nstored as textfile;\n\nCREATE EXTERNAL TABLE if not exists pae_staging.iso3(\n    country_code varchar(10), \n    iso3_code varchar(255)\n    )\nrow format delimited\nfields terminated by ':'\nlines terminated by '\\n'\nstored as textfile;\n\nCREATE EXTERNAL TABLE if not exists pae_staging.names(\n    country_code varchar(10), \n    country_full_name varchar(255)\n    )\nrow format delimited\nfields terminated by ':'\nlines terminated by '\\n'\nstored as textfile;\n\nCREATE EXTERNAL TABLE if not exists pae_staging.phone(\n    country_code varchar(10), \n    phone_code varchar(255)\n    )\nrow format delimited\nfields terminated by ':'\nlines terminated by '\\n'\nstored as textfile;","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T13:47:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1615843536149_743770557","id":"20210315-212536_1515646295","dateCreated":"2021-03-15T21:25:36+0000","dateStarted":"2021-03-15T22:03:59+0000","dateFinished":"2021-03-15T22:03:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165061"},{"title":"PUT DATA FROM JSON TO PAE_STAGING","text":"%python\nimport subprocess\n\n\nif not os.path.exists('/tmp/pae'):\n    os.mkdir('/tmp/pae')\n    \ndef write_json_to_db(json_file:str):\n    base_file_name = os.path.basename(json_file).split('.')[0]\n    tmp_path = os.path.join('/tmp/pae',base_file_name + '.txt')\n    with open(json_file,'r') as infile:\n        json_tmp = json.load(infile)\n    with open(tmp_path, 'w') as output:\n        for k in json_tmp.keys():\n            output.write(f\"{k}:{json_tmp[k]}\"+'\\n')\n            \n    subprocess.run(['hdfs', 'dfs', '-put', tmp_path, f\"/apps/hive/warehouse/pae_staging.db/{base_file_name}/file\" ])\n    \n    return 0\n        \nlist(map(write_json_to_db, json_files))\n","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-15T22:24:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\n[0, 0, 0, 0, 0, 0]\n"}]},"apps":[],"jobName":"paragraph_1615844838588_-442790039","id":"20210315-214718_318791152","dateCreated":"2021-03-15T21:47:18+0000","dateStarted":"2021-03-15T22:23:02+0000","dateFinished":"2021-03-15T22:23:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165062"},{"text":"%hive\nSELECT * FROM pae_staging.iso3 LIMIT 5","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:23:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"iso3.country_code":"string","iso3.iso3_code":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"iso3.country_code\tiso3.iso3_code\nBD\tBGD\nBE\tBEL\nBF\tBFA\nBG\tBGR\nBA\tBIH\n"}]},"apps":[],"jobName":"paragraph_1615847022482_1886889800","id":"20210315-222342_613695762","dateCreated":"2021-03-15T22:23:42+0000","dateStarted":"2021-03-15T22:24:17+0000","dateFinished":"2021-03-15T22:24:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165063","title":"CHECK pae_staging.iso3 IF IT IS OK"},{"title":"ADDING CSV FILES TO DB","text":"%sh\nhdfs dfs -find /home/deng/Data -name \"*csv\"","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T13:48:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\n/home/deng/Data/cities.csv\n/home/deng/Data/countries_of_the_world.csv\n/home/deng/Data/nobel-laureates.csv\n/home/deng/Data/nobel_laureates.csv\n"}]},"apps":[],"jobName":"paragraph_1615902450761_2135856872","id":"20210316-134730_1161155826","dateCreated":"2021-03-16T13:47:30+0000","dateStarted":"2021-03-16T13:48:50+0000","dateFinished":"2021-03-16T13:48:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165069"},{"text":"%sh\nhead -5 /home/deng/Data/countries_of_the_world.csv","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:27:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Country,Region,Population,Area (sq. mi.),Pop. Density (per sq. mi.),Coastline (coast/area ratio),Net migration,Infant mortality (per 1000 births),GDP ($ per capita),Literacy (%),Phones (per 1000),Arable (%),Crops (%),Other (%),Climate,Birthrate,Deathrate,Agriculture,Industry,Service\n\"Afghanistan \",\"ASIA (EX. NEAR EAST)         \",31056997,647500,\"48,0\",\"0,00\",\"23,06\",\"163,07\",700,\"36,0\",\"3,2\",\"12,13\",\"0,22\",\"87,65\",1,\"46,6\",\"20,34\",\"0,38\",\"0,24\",\"0,38\"\n\"Albania \",\"EASTERN EUROPE                     \",3581655,28748,\"124,6\",\"1,26\",\"-4,93\",\"21,52\",4500,\"86,5\",\"71,2\",\"21,09\",\"4,42\",\"74,49\",3,\"15,11\",\"5,22\",\"0,232\",\"0,188\",\"0,579\"\n\"Algeria \",\"NORTHERN AFRICA                    \",32930091,2381740,\"13,8\",\"0,04\",\"-0,39\",31,6000,\"70,0\",\"78,1\",\"3,22\",\"0,25\",\"96,53\",1,\"17,14\",\"4,61\",\"0,101\",\"0,6\",\"0,298\"\n\"American Samoa \",\"OCEANIA                            \",57794,199,\"290,4\",\"58,29\",\"-20,71\",\"9,27\",8000,\"97,0\",\"259,5\",10,15,75,2,\"22,46\",\"3,27\",,,\n"}]},"apps":[],"jobName":"paragraph_1615902546940_-1712129678","id":"20210316-134906_1163861864","dateCreated":"2021-03-16T13:49:06+0000","dateStarted":"2021-03-16T20:25:23+0000","dateFinished":"2021-03-16T20:25:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165070","title":"READ 5 lines to find out schema ( -head not good for that)"},{"text":"%python\n\nimport pandas as pd\n\npd.options.display.max_columns = 50","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:27:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","Region":"string","Population":"string","Area (sq. mi.)":"string","Pop. Density (per sq. mi.)":"string","Coastline (coast/area ratio)":"string","Net migration":"string","Infant mortality (per 1000 births)":"string","GDP ($ per capita)":"string","Literacy (%)":"string","Phones (per 1000)":"string","Arable (%)":"string","Crops (%)":"string","Other (%)":"string","Climate":"string","Birthrate":"string","Deathrate":"string","Agriculture":"string","Industry":"string","Service":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1615902637375_-1374860908","id":"20210316-135037_1669577679","dateCreated":"2021-03-16T13:50:37+0000","dateStarted":"2021-03-16T20:09:30+0000","dateFinished":"2021-03-16T20:09:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165071","title":"READ 5 lines to find out schema with pandas"},{"text":"%python\ncountries = pd.read_csv(\"/home/deng/Data/countries_of_the_world.csv\")\ncountries.to_csv('/tmp/pae/countries_of_the_world.csv', sep='\\t', index=False)\nz.show(countries.head())","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T18:35:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","Region":"string","Population":"string","Area (sq. mi.)":"string","Pop. Density (per sq. mi.)":"string","Coastline (coast/area ratio)":"string","Net migration":"string","Infant mortality (per 1000 births)":"string","GDP ($ per capita)":"string","Literacy (%)":"string","Phones (per 1000)":"string","Arable (%)":"string","Crops (%)":"string","Other (%)":"string","Climate":"string","Birthrate":"string","Deathrate":"string","Agriculture":"string","Industry":"string","Service":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Country\tRegion\tPopulation\tArea (sq. mi.)\tPop. Density (per sq. mi.)\tCoastline (coast/area ratio)\tNet migration\tInfant mortality (per 1000 births)\tGDP ($ per capita)\tLiteracy (%)\tPhones (per 1000)\tArable (%)\tCrops (%)\tOther (%)\tClimate\tBirthrate\tDeathrate\tAgriculture\tIndustry\tService\nAfghanistan \tASIA (EX. NEAR EAST)         \t31056997\t647500\t48,0\t0,00\t23,06\t163,07\t700.0\t36,0\t3,2\t12,13\t0,22\t87,65\t1\t46,6\t20,34\t0,38\t0,24\t0,38\nAlbania \tEASTERN EUROPE                     \t3581655\t28748\t124,6\t1,26\t-4,93\t21,52\t4500.0\t86,5\t71,2\t21,09\t4,42\t74,49\t3\t15,11\t5,22\t0,232\t0,188\t0,579\nAlgeria \tNORTHERN AFRICA                    \t32930091\t2381740\t13,8\t0,04\t-0,39\t31\t6000.0\t70,0\t78,1\t3,22\t0,25\t96,53\t1\t17,14\t4,61\t0,101\t0,6\t0,298\nAmerican Samoa \tOCEANIA                            \t57794\t199\t290,4\t58,29\t-20,71\t9,27\t8000.0\t97,0\t259,5\t10\t15\t75\t2\t22,46\t3,27\tnan\tnan\tnan\nAndorra \tWESTERN EUROPE                     \t71201\t468\t152,1\t0,00\t6,6\t4,05\t19000.0\t100,0\t497,2\t2,22\t0\t97,78\t3\t8,71\t6,25\tnan\tnan\tnan\n"}]},"apps":[],"jobName":"paragraph_1615902925441_1867415442","id":"20210316-135525_876246124","dateCreated":"2021-03-16T13:55:25+0000","dateStarted":"2021-03-16T18:35:43+0000","dateFinished":"2021-03-16T18:35:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165072"},{"text":"%python\nlaureates = pd.read_csv(\"/home/deng/Data/nobel-laureates.csv\")\nlaureates.to_csv('/tmp/pae/nobel-laureates.csv', sep='\\t', index=False)\nz.show(laureates.head())","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T18:35:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Year":"string","Category":"string","Prize":"string","Motivation":"string","Prize Share":"string","Laureate ID":"string","Laureate Type":"string","Full Name":"string","Birth Date":"string","Birth City":"string","Birth Country":"string","Sex":"string","Organization Name":"string","Organization City":"string","Organization Country":"string","Death Date":"string","Death City":"string","Death Country":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Year\tCategory\tPrize\tMotivation\tPrize Share\tLaureate ID\tLaureate Type\tFull Name\tBirth Date\tBirth City\tBirth Country\tSex\tOrganization Name\tOrganization City\tOrganization Country\tDeath Date\tDeath City\tDeath Country\n1901\tChemistry\tThe Nobel Prize in Chemistry 1901\t\"in recognition of the extraordinary services he has rendered by the discovery of the laws of chemical dynamics and osmotic pressure in solutions\"\t1/1\t160\tIndividual\tJacobus Henricus van 't Hoff\t1852-08-30\tRotterdam\tNetherlands\tMale\tBerlin University\tBerlin\tGermany\t1911-03-01\tBerlin\tGermany\n1901\tLiterature\tThe Nobel Prize in Literature 1901\t\"in special recognition of his poetic composition, which gives evidence of lofty idealism, artistic perfection and a rare combination of the qualities of both heart and intellect\"\t1/1\t569\tIndividual\tSully Prudhomme\t1839-03-16\tParis\tFrance\tMale\tnan\tnan\tnan\t1907-09-07\tChâtenay\tFrance\n1901\tMedicine\tThe Nobel Prize in Physiology or Medicine 1901\t\"for his work on serum therapy, especially its application against diphtheria, by which he has opened a new road in the domain of medical science and thereby placed in the hands of the physician a victorious weapon against illness and deaths\"\t1/1\t293\tIndividual\tEmil Adolf von Behring\t1854-03-15\tHansdorf (Lawice)\tPrussia (Poland)\tMale\tMarburg University\tMarburg\tGermany\t1917-03-31\tMarburg\tGermany\n1901\tPeace\tThe Nobel Peace Prize 1901\tnan\t1/2\t462\tIndividual\tJean Henry Dunant\t1828-05-08\tGeneva\tSwitzerland\tMale\tnan\tnan\tnan\t1910-10-30\tHeiden\tSwitzerland\n1901\tPeace\tThe Nobel Peace Prize 1901\tnan\t1/2\t463\tIndividual\tFrédéric Passy\t1822-05-20\tParis\tFrance\tMale\tnan\tnan\tnan\t1912-06-12\tParis\tFrance\n"}]},"apps":[],"jobName":"paragraph_1615902940680_-128928312","id":"20210316-135540_773280913","dateCreated":"2021-03-16T13:55:40+0000","dateStarted":"2021-03-16T18:35:51+0000","dateFinished":"2021-03-16T18:35:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165073"},{"text":"%python\nwith open('/home/deng/Data/nobel-laureates.csv') as f:\n    print(f.readlines()[:2])","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:27:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Year,Category,Prize,Motivation,Prize Share,Laureate ID,Laureate Type,Full Name,Birth Date,Birth City,Birth Country,Sex,Organization Name,Organization City,Organization Country,Death Date,Death City,Death Country\\n', '1901,Chemistry,The Nobel Prize in Chemistry 1901,\"\"\"in recognition of the extraordinary services he has rendered by the discovery of the laws of chemical dynamics and osmotic pressure in solutions\"\"\",1/1,160,Individual,Jacobus Henricus van \\'t Hoff,1852-08-30,Rotterdam,Netherlands,Male,Berlin University,Berlin,Germany,1911-03-01,Berlin,Germany\\n']\n"}]},"apps":[],"jobName":"paragraph_1615918928823_1698839951","id":"20210316-182208_367947905","dateCreated":"2021-03-16T18:22:08+0000","dateStarted":"2021-03-16T20:27:31+0000","dateFinished":"2021-03-16T20:27:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165074"},{"text":"%python\nimport re\n\n\nlist(map(lambda x: re.sub('[\\s./\\(\\)$]','_',x).replace('__','_'), laureates.columns))","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T14:19:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Year', 'Category', 'Prize', 'Motivation', 'Prize_Share', 'Laureate_ID', 'Laureate_Type', 'Full_Name', 'Birth_Date', 'Birth_City', 'Birth_Country', 'Sex', 'Organization_Name', 'Organization_City', 'Organization_Country', 'Death_Date', 'Death_City', 'Death_Country']\n"}]},"apps":[],"jobName":"paragraph_1615903202697_-1864928768","id":"20210316-140002_503674954","dateCreated":"2021-03-16T14:00:02+0000","dateStarted":"2021-03-16T14:19:40+0000","dateFinished":"2021-03-16T14:19:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165076"},{"title":"CREATE TABLE FOR CSV FILES","text":"%hive\n\nCREATE EXTERNAL TABLE if not exists pae_staging.countries_of_the_world(\nCountry VARCHAR(100),\nRegion VARCHAR(100),\nPopulation INTEGER,\nArea_sq_mi INTEGER,\nPop_Density_per_sq_mi decimal(10,0),\nCoastline_coast_area_ratio decimal(10,0),\nNet_migration decimal(10,0), \nInfant_mortality_per_1000_births decimal(10,0),\nGDP_per_capita INTEGER,\nLiteracy_pct decimal(10,0),\nPhones_per_1000  decimal(10,0),\nArable_pct  decimal(10,0),\nCrops_pct  decimal(10,0),\nOther_pct  decimal(10,0),\nClimate  INTEGER,\nBirthrate  decimal(10,0),\nDeathrate  decimal(10,0),\nAgriculture  decimal(10,0),\nIndustry  decimal(10,0),\nService  decimal(10,0)\n)\nrow format delimited\nfields terminated by '\\t'\nlines terminated by '\\n'\ntblproperties (\"skip.header.line.count\"=\"1\");\n\nCREATE EXTERNAL TABLE if not exists pae_staging.nobel_laureates(\nYear INTEGER,\nCategory VARCHAR(255),\nPrize VARCHAR(255),\nMotivation VARCHAR(255),\nPrize_Share VARCHAR(10),\nLaureate_ID INTEGER,\nLaureate_Type VARCHAR(255),\nFull_Name VARCHAR(255),\nBirth_Date DATE,\nBirth_City VARCHAR(100),\nBirth_Country VARCHAR(100),\nSex VARCHAR(10),\nOrganization_Name VARCHAR(255),\nOrganization_City VARCHAR(255),\nOrganization_Country VARCHAR(255),\nDeath_Date date,\nDeath_City VARCHAR(255),\nDeath_Country VARCHAR(255)\n)\nrow format delimited\nfields terminated by '\\t'\nlines terminated by '\\n'\ntblproperties (\"skip.header.line.count\"=\"1\")\n\n","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T18:35:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1615902295131_938755457","id":"20210316-134455_1537645860","dateCreated":"2021-03-16T13:44:55+0000","dateStarted":"2021-03-16T18:35:17+0000","dateFinished":"2021-03-16T18:35:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165077"},{"title":"PUT DATA FROM CSV TO PAE_STAGING","text":"%sh\nhdfs dfs -put /tmp/pae/countries_of_the_world.csv /apps/hive/warehouse/pae_staging.db/countries_of_the_world/file\nhdfs dfs -put /tmp/pae/nobel-laureates.csv /apps/hive/warehouse/pae_staging.db/nobel_laureates/file","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T18:36:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\n"}]},"apps":[],"jobName":"paragraph_1615844337142_-296581286","id":"20210315-213857_815593352","dateCreated":"2021-03-15T21:38:57+0000","dateStarted":"2021-03-16T18:36:05+0000","dateFinished":"2021-03-16T18:36:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165080"},{"text":"%hive\nSELECT * FROM pae_staging.nobel_laureates LIMIT 5\n","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:29:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"nobel_laureates.year":"string","nobel_laureates.category":"string","nobel_laureates.prize":"string","nobel_laureates.motivation":"string","nobel_laureates.prize_share":"string","nobel_laureates.laureate_id":"string","nobel_laureates.laureate_type":"string","nobel_laureates.full_name":"string","nobel_laureates.birth_date":"string","nobel_laureates.birth_city":"string","nobel_laureates.birth_country":"string","nobel_laureates.sex":"string","nobel_laureates.organization_name":"string","nobel_laureates.organization_city":"string","nobel_laureates.organization_country":"string","nobel_laureates.death_date":"string","nobel_laureates.death_city":"string","nobel_laureates.death_country":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"nobel_laureates.year\tnobel_laureates.category\tnobel_laureates.prize\tnobel_laureates.motivation\tnobel_laureates.prize_share\tnobel_laureates.laureate_id\tnobel_laureates.laureate_type\tnobel_laureates.full_name\tnobel_laureates.birth_date\tnobel_laureates.birth_city\tnobel_laureates.birth_country\tnobel_laureates.sex\tnobel_laureates.organization_name\tnobel_laureates.organization_city\tnobel_laureates.organization_country\tnobel_laureates.death_date\tnobel_laureates.death_city\tnobel_laureates.death_country\n1901\tChemistry\tThe Nobel Prize in Chemistry 1901\t\"\"\"in recognition of the extraordinary services he has rendered by the discovery of the laws of chemical dynamics and osmotic pressure in solutions\"\"\"\t1/1\t160\tIndividual\tJacobus Henricus van 't Hoff\t1852-08-30\tRotterdam\tNetherlands\tMale\tBerlin University\tBerlin\tGermany\t1911-03-01\tBerlin\tGermany\n1901\tLiterature\tThe Nobel Prize in Literature 1901\t\"\"\"in special recognition of his poetic composition, which gives evidence of lofty idealism, artistic perfection and a rare combination of the qualities of both heart and intellect\"\"\"\t1/1\t569\tIndividual\tSully Prudhomme\t1839-03-16\tParis\tFrance\tMale\t\t\t\t1907-09-07\tChâtenay\tFrance\n1901\tMedicine\tThe Nobel Prize in Physiology or Medicine 1901\t\"\"\"for his work on serum therapy, especially its application against diphtheria, by which he has opened a new road in the domain of medical science and thereby placed in the hands of the physician a victorious weapon against illness and deaths\"\"\"\t1/1\t293\tIndividual\tEmil Adolf von Behring\t1854-03-15\tHansdorf (Lawice)\tPrussia (Poland)\tMale\tMarburg University\tMarburg\tGermany\t1917-03-31\tMarburg\tGermany\n1901\tPeace\tThe Nobel Peace Prize 1901\t\t1/2\t462\tIndividual\tJean Henry Dunant\t1828-05-08\tGeneva\tSwitzerland\tMale\t\t\t\t1910-10-30\tHeiden\tSwitzerland\n1901\tPeace\tThe Nobel Peace Prize 1901\t\t1/2\t463\tIndividual\tFrédéric Passy\t1822-05-20\tParis\tFrance\tMale\t\t\t\t1912-06-12\tParis\tFrance\n"}]},"apps":[],"jobName":"paragraph_1615844645434_-1710542279","id":"20210315-214405_684446402","dateCreated":"2021-03-15T21:44:05+0000","dateStarted":"2021-03-16T20:28:46+0000","dateFinished":"2021-03-16T20:28:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165081","title":"CHECK RESULTS"},{"text":"%hive\nSELECT * FROM pae_staging.countries_of_the_world LIMIT 5","user":"pastukhanovae@cbr.ru","dateUpdated":"2021-03-16T20:28:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"countries_of_the_world.country":"string","countries_of_the_world.region":"string","countries_of_the_world.population":"string","countries_of_the_world.area_sq_mi":"string","countries_of_the_world.pop_density_per_sq_mi":"string","countries_of_the_world.coastline_coast_area_ratio":"string","countries_of_the_world.net_migration":"string","countries_of_the_world.infant_mortality_per_1000_births":"string","countries_of_the_world.gdp_per_capita":"string","countries_of_the_world.literacy_pct":"string","countries_of_the_world.phones_per_1000":"string","countries_of_the_world.arable_pct":"string","countries_of_the_world.crops_pct":"string","countries_of_the_world.other_pct":"string","countries_of_the_world.climate":"string","countries_of_the_world.birthrate":"string","countries_of_the_world.deathrate":"string","countries_of_the_world.agriculture":"string","countries_of_the_world.industry":"string","countries_of_the_world.service":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1615926508122_-227418580","id":"20210316-202828_1829876218","dateCreated":"2021-03-16T20:28:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:182766","dateFinished":"2021-03-16T20:28:51+0000","dateStarted":"2021-03-16T20:28:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"countries_of_the_world.country\tcountries_of_the_world.region\tcountries_of_the_world.population\tcountries_of_the_world.area_sq_mi\tcountries_of_the_world.pop_density_per_sq_mi\tcountries_of_the_world.coastline_coast_area_ratio\tcountries_of_the_world.net_migration\tcountries_of_the_world.infant_mortality_per_1000_births\tcountries_of_the_world.gdp_per_capita\tcountries_of_the_world.literacy_pct\tcountries_of_the_world.phones_per_1000\tcountries_of_the_world.arable_pct\tcountries_of_the_world.crops_pct\tcountries_of_the_world.other_pct\tcountries_of_the_world.climate\tcountries_of_the_world.birthrate\tcountries_of_the_world.deathrate\tcountries_of_the_world.agriculture\tcountries_of_the_world.industry\tcountries_of_the_world.service\nAfghanistan \tASIA (EX. NEAR EAST)         \t31056997\t647500\tnull\tnull\tnull\tnull\t700\tnull\tnull\tnull\tnull\tnull\t1\tnull\tnull\tnull\tnull\tnull\nAlbania \tEASTERN EUROPE                     \t3581655\t28748\tnull\tnull\tnull\tnull\t4500\tnull\tnull\tnull\tnull\tnull\t3\tnull\tnull\tnull\tnull\tnull\nAlgeria \tNORTHERN AFRICA                    \t32930091\t2381740\tnull\tnull\tnull\t31\t6000\tnull\tnull\tnull\tnull\tnull\t1\tnull\tnull\tnull\tnull\tnull\nAmerican Samoa \tOCEANIA                            \t57794\t199\tnull\tnull\tnull\tnull\t8000\tnull\tnull\t10\t15\t75\t2\tnull\tnull\tnull\tnull\tnull\nAndorra \tWESTERN EUROPE                     \t71201\t468\tnull\tnull\tnull\tnull\t19000\tnull\tnull\tnull\t0\tnull\t3\tnull\tnull\tnull\tnull\tnull\n"}]}}],"name":"pae/module2_HW","id":"2FZ8C8WGZ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"mysql:shared_process":[],"sh:shared_process":[],"spark:pastukhanovae@cbr.ru:":[],"hive:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}